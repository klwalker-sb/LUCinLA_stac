
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>cleaning files &#8212; LUCinLA_stac</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="troubleshooting errors" href="Errors.html" />
    <link rel="prev" title="Pipeline process" href="Pipeline.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      <img src="_static/cover.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">LUCinLA_stac</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Land-Use Change in Latin America (LUCinLA) Computing Guide
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Overview
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="General_framework.html">
   General framework
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Project_background.html">
   Project background
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Processing_overview.html">
   Processing overview
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Computer setup
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Connecting_to_cluster.html">
   Connecting to the ERI cluster
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="environment_setup.html">
   Setting up your remote environment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Transfering_files.html">
   Transfering Files to/from cluster
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Processing
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Processing.html">
   Processing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Downloading.html">
   Downloading process
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Pre_Pipeline.html">
   Post-download processing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Pipeline.html">
   Pipeline process
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   cleaning files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Errors.html">
   troubleshooting errors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Jupyter_Notebook.html">
   Using Jupyter Notebook to interact with data on cluster
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Classification
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Classification_overview.html">
   classification overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Classification_rf.html">
   modelling / classification steps
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  New project configuration
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="setting_up_new_project.html">
   setting up new project
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Computing resources
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro_to_git.html">
   Intro to git
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="commandLine_bash.html">
   command line
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="vim.html">
   Vim
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="slurm.html">
   Slurm
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="editing_this_guide.html">
   To edit this guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="quebracho.html">
   quebracho
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Cited References
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="bibliography.html">
   cited references
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Cleaning_files.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://klwalker-sb.github.io/LUCinLA_stac/"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://klwalker-sb.github.io/LUCinLA_stac//issues/new?title=Issue%20on%20page%20%2FCleaning_files.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#as-part-of-the-regular-pipeline-procedure">
   As part of the regular pipeline procedure:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#as-a-mechanism-to-delete-corrupted-files">
   As a mechanism to delete corrupted files:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#as-a-mechanism-to-remove-unwanted-images">
   As a mechanism to remove unwanted images:
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="cleaning-files">
<span id="cleaning"></span><h1>cleaning files<a class="headerlink" href="#cleaning-files" title="Permalink to this headline">¶</a></h1>
<p>================================================================================================================================
use <code class="docutils literal notranslate"><span class="pre">tuyau</span> <span class="pre">clean</span></code> to clean out files that are no longer needed and to properly delete corrupted files.</p>
<div class="section" id="as-part-of-the-regular-pipeline-procedure">
<h2>As part of the regular pipeline procedure:<a class="headerlink" href="#as-part-of-the-regular-pipeline-procedure" title="Permalink to this headline">¶</a></h2>
<p>Following the time series step in the pipeline, <code class="docutils literal notranslate"><span class="pre">tuyau</span> <span class="pre">clean</span></code> can be used to delete the original download files and free up quite a bit of memory (downloads consume ~100GB of memory per cell for a 2000-2022 time series)</p>
<p><strong>Make sure the parameter <code class="docutils literal notranslate"><span class="pre">clean:delete_record</span></code> is set to <code class="docutils literal notranslate"><span class="pre">False</span></code></strong> (its default). As long as <code class="docutils literal notranslate"><span class="pre">clean:delete_record</span></code> is not set to True, the record will be preserved in the <code class="docutils literal notranslate"><span class="pre">processing.info</span></code> database and any processed files will not be redownloaded. (Even if <code class="docutils literal notranslate"><span class="pre">processing.info</span></code> is deleted, it can be recreated (albeit with less info) from the files in the brdf folder, so processed files need not be redownloaded with future updates)</p>
<p>The recommended parameter configuration for regular file cleaning can be found in the bash script <code class="docutils literal notranslate"><span class="pre">eostac_clean.sh</span></code> (in sandbox-cel/paraguay_lc/templates). By default, this will clean out both the download folders and the nocoreg folder (the nocoreg folder contains a copy of each brdf prior to the coreg step. This can be used to check the accuracy of the coreg step, but does take up a bit of memory).</p>
</div>
<div class="section" id="as-a-mechanism-to-delete-corrupted-files">
<h2>As a mechanism to delete corrupted files:<a class="headerlink" href="#as-a-mechanism-to-delete-corrupted-files" title="Permalink to this headline">¶</a></h2>
<p>In the case of corrupted files or other files that should be reprocessed after removal, <code class="docutils literal notranslate"><span class="pre">clean:delete_record</span></code> should be set to <code class="docutils literal notranslate"><span class="pre">True</span></code>. This ensures that the file record is deleted from <code class="docutils literal notranslate"><span class="pre">processing.info</span></code> when the file is deleted from the downloads folder so that is is able to be redownloaded. If the file has been run through the brdf stage, the corresponding brdf file is also deleted (which can be tricky manually as it can have a variety of file names, depending on whether the coreg step has been run and whether it succeeded). The brdf field is reset to NaN in <code class="docutils literal notranslate"><span class="pre">processing.info</span></code> so that it can be recreated.
If a brdf file is corrupted and not the download itself, you can set <code class="docutils literal notranslate"><span class="pre">clean:remove_items</span></code> to <code class="docutils literal notranslate"><span class="pre">'\[brdf]\'</span></code> to remove only the brdf file and record.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>if <code class="docutils literal notranslate"><span class="pre">clean:delete_record</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code> in <code class="docutils literal notranslate"><span class="pre">tuyau</span> <span class="pre">clean</span></code>, the brdf file and record will be deleted even if <code class="docutils literal notranslate"><span class="pre">brdf</span></code> is not in <code class="docutils literal notranslate"><span class="pre">clean:remove_items</span></code>. This allows/forces the item to be reprocessed in future runs of the downloading/brdf processes.</p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">eostac_clean_removeFromDB.sh</span></code> (in sandbox-cel/paraguay_lc/templates) has the recommended configuration to remove corrupted downloads.
files to be cleaned can be specified with the parameters:
*<code class="docutils literal notranslate"><span class="pre">clean:sat_sensors</span></code> (options = S2A,S2B,LT05,LE07,LC08,LC09,S2(for all sentinel only),L(for all Landsat only) or All)
*<code class="docutils literal notranslate"><span class="pre">clean:date_range</span></code>  (format: ‘[YYYYMMDD, YYYYMMDD]’. if a single image is to be cleaned, can use ‘[YYYYMMDD]’. if all files are to be cleaned (all dates), use ‘[0]’)
*<code class="docutils literal notranslate"><span class="pre">clean:xlist</span></code> can be used to provide a list of images to remove (format is path to .csv file with one image per row (no heading)). File names can be from download or brdf folder (if from download, will remove brdf as well)</p>
</div>
<div class="section" id="as-a-mechanism-to-remove-unwanted-images">
<h2>As a mechanism to remove unwanted images:<a class="headerlink" href="#as-a-mechanism-to-remove-unwanted-images" title="Permalink to this headline">¶</a></h2>
<p>This is useful if you want to remove a list of images that are deemed to be low quality, for example. This list can be generated using the LUCinSA_helpers create_thubnails method followed by the thumbnail_filter notebook.</p>
<p>in <code class="docutils literal notranslate"><span class="pre">tuyau</span> <span class="pre">clean</span></code>, set <code class="docutils literal notranslate"><span class="pre">clean:delete_record</span></code> to <code class="docutils literal notranslate"><span class="pre">False</span></code> and set <code class="docutils literal notranslate"><span class="pre">clean:xlist</span></code> to the path to your list of images to remove (formated as .csv file with one image per row (no heading)). File names can be from download or brdf folder (if from download, will remove brdf as well)
When <code class="docutils literal notranslate"><span class="pre">clean:delete_record</span></code> is set to False, the record will remain in <code class="docutils literal notranslate"><span class="pre">processing.info</span></code> and will be flagged so that it is not reprocessed with future updates.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="Pipeline.html" title="previous page">Pipeline process</a>
    <a class='right-next' id="next-link" href="Errors.html" title="next page">troubleshooting errors</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Kendra Walker<br/>
        
            &copy; Copyright 2023.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>